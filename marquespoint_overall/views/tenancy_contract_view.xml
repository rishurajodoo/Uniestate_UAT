<odoo>
    <data>
        <record id="tenancy_contract_seq" model="ir.sequence">
            <field name="name">Tenancy Contract Sequence</field>
            <field name="code">tenancy.contract.seq</field>
            <field name="prefix">TC</field>
            <field name="padding">5</field>
            <field name="company_id" eval="False"/>
        </record>
        <!--    Kanban View-->
        <record id="view_tenancy_contract_kanban" model="ir.ui.view">
            <field name="name">tenancy.contract.kanban</field>
            <field name="model">tenancy.contract</field>
            <field name="arch" type="xml">
                <kanban default_group_by="state" sample="1">
                    <field name="id"/>
                    <field name="name"/>
                    <field name="partner_id"/>
                    <field name="amount"/>
                    <field name="start_date"/>
                    <field name="end_date"/>
                    <field name="state"/>
                    <templates>
                        <t t-name="kanban-box">
                            <div t-attf-class="oe_kanban_card oe_kanban_global_click">
                                <div class="o_kanban_record_top mb16">
                                    <div class="o_kanban_record_headings mt4">
                                        <strong class="o_kanban_record_title">
                                            <span>
                                                <strong>
                                                    <!--                                                    <field name="partner_id"/>-->
                                                    <t t-esc="record.partner_id.value"/>
                                                </strong>
                                                [<field name="unit_id"/>]
                                            </span>
                                        </strong>
                                    </div>
                                    <strong>
                                        <field name="amount" widget="monetary"/>
                                    </strong>
                                </div>
                                <div class="o_kanban_record_bottom">
                                    <div class="oe_kanban_bottom_left text-muted">
                                        <span>
                                            <field name="start_date"/>
                                            -
                                            <field name="end_date"/>
                                        </span>
                                    </div>
                                    <div class="oe_kanban_bottom_right">
                                        <field name="state" widget="label_selection"
                                               options="{'classes': {'new': 'default', 'new': 'success', 'closed': 'danger'}}"/>
                                    </div>
                                </div>
                            </div>
                        </t>
                    </templates>
                </kanban>
            </field>
        </record>
        <!--Form View-->
        <record id="view_tenancy_contract_form" model="ir.ui.view">
            <field name="name">tenancy.contract.form</field>
            <field name="model">tenancy.contract</field>
            <field name="arch" type="xml">
                <form string="Tenancy Contract">
                    <header>
                        <!--                        <button type="object" name="action_open" string="In Progress" icon="fa-play" class="oe_highlight"/>-->
                        <!--                        <button type="object" name="action_close" string="Closed" icon="fa-times" class="oe_highlight"/>-->
                        <button type="object" name="action_reset" string="Reset" icon="fa-undo" class="oe_highlight"/>
                        <button type="object" name="action_close_one" string="Early Termination" icon="fa-times"
                                class="oe_highlight"/>
                        <button type="object" name="action_close_two" string="Termination" icon="fa-times"
                                class="oe_highlight"/>
                        <button type="object" name="action_renew" string="Renew" icon="fa-undo" class="oe_highlight"/>
                        <field name="state" widget="statusbar"
                               statusbar_visible="new,renew,open,closed"/>
                    </header>
                    <sheet>
                        <div class="oe_button_box" name="button_box">
                            <button name="action_show_so"
                                    type="object"
                                    class="oe_stat_button"
                                    icon="fa-bars"
                                    string="Sale Orders">
                            </button>
                            <button name="action_show_invoice"
                                    type="object"
                                    class="oe_stat_button"
                                    icon="fa-pencil-square-o"
                                    string="Invoices">
                            </button>
                            <button name="action_show_pdc"
                                    type="object"
                                    class="oe_stat_button"
                                    icon="fa-list-alt"
                                    string="PDC">
                            </button>
                            <button name="action_show_request"
                                    type="object"
                                    class="oe_stat_button"
                                    icon="fa-external-link-square"
                                    string="Request">
                            </button>
                            <button name="action_show_deffered_revenue"
                                    type="object"
                                    class="oe_stat_button"
                                    icon="fa-list-alt"
                                    string="Deffered Revenue">
                            </button>
                            <!--                            <button name="action_show_differed"-->
                            <!--                                    type="object"-->
                            <!--                                    class="oe_stat_button"-->
                            <!--                                    icon="fa-bars"-->
                            <!--                                    string="Deffered Revenues">-->
                            <!--                            </button>-->
                        </div>
                        <br/>
                        <h1 class="oe_title">
                            <field name="name" readonly="1"/>
                        </h1>
                        <group col="4" string="Period">
                            <field name="start_date"/>
                            <field name="end_date"/>
                        </group>
                        <group col="4" string="Property Details">
                            <field name="project_id"/>
                            <field name="building_id"/>
                            <field name="floor_id"/>
                            <field name="unit_id" widget="many2many_tags"/>
                            <field name="partner_id"/>
                            <field name="amount"/>
                            <field name="order_id" readonly="1"/>
                            <field name="show_refund_close_tab" invisible="1"/>
                            <field name="show_standard_close_tab" invisible="1"/>
                        </group>
                        <notebook>
                            <!-- First Tab -->
                            <page string="Refund and Close" name="first_tab" invisible="show_refund_close_tab == False">
                                <button type="object" name="action_submit_ref_close" string="Submit"
                                        class="oe_highlight"
                                        invisible="req_approve_stage != 'approved' and approve_stage != 'approved'"/>
                                <notebook>
                                    <page string="Maintenance" name="sub_page_1">
                                        <!-- Fields for the sub-page 1 -->
                                        <button type="object" name="action_request" string="Maintenance Request"
                                                class="oe_highlight"/>
                                        <group>
                                            <group string="Approval Details">
                                                <field name="req_approve_stage" widget="badge"/>
                                                <field name="req_approve_by"/>
                                                <field name="req_approve_date"/>
                                            </group>
                                        </group>
                                    </page>
                                    <page string="Deffered Revenue" name="sub_page_1">
                                        <button type="object" name="action_sent_approve" string="Request for Apprval"
                                                class="oe_highlight"/>
                                        <group>
                                            <group string="Approval Details">
                                                <field name="approve_stage" widget="badge"/>
                                                <field name="approve_by"/>
                                                <field name="approve_date"/>
                                            </group>
                                        </group>
                                    </page>
                                    <page string="Termination" name="sub_page_1">
                                        <group>
                                            <group string="Invoice Details">
                                                <field name="outstanding_amount"/>
                                                <field name="payable_amount"/>
                                                <field name="maintenance_request_amount" readonly="1"/>
                                                <field name="security_deposit_amount" readonly="1"/>
                                                <field name="early_termination_period"/>
                                                <field name="early_termination_penalty_amount"/>
                                                <field name="deferred_revenue_amount"/>
                                                <field name="refundable_amount"/>

                                                <button string="Create Invoice" class="btn btn-primary"
                                                        name="create_invoice"
                                                        type="object"/>
                                            </group>
                                        </group>
                                    </page>
                                    <!--                                    <page string="Deffered Revenue" name="sub_page_2">-->
                                    <!--                                        &lt;!&ndash; Fields for the sub-page 1 &ndash;&gt;-->
                                    <!--                                        <group>-->
                                    <!--                                            <group>-->
                                    <!--                                                <button type="object" name="action_request" string="Submit" class="oe_highlight"/>-->
                                    <!--                                            </group>-->
                                    <!--                                            <group>-->

                                    <!--                                            </group>-->
                                    <!--                                        </group>-->
                                    <!--                                    </page>-->
                                </notebook>
                            </page>
                            <page string="Standard Close" name="second_tab"
                                  invisible="show_standard_close_tab == False">
                                <button type="object" name="action_submit_stand_close" string="Submit"
                                        class="oe_highlight"/>
                                <notebook>
                                    <page string="Maintenance" name="sub_page_1">
                                        <button type="object" name="action_request" string="Mantinance Request"
                                                class="oe_highlight"/>
                                        <group>
                                            <group string="Approval Details">
                                                <field name="req_approve_stage"/>
                                                <field name="req_approve_by"/>
                                                <field name="req_approve_date"/>
                                            </group>
                                        </group>
                                    </page>
                                </notebook>
                            </page>
                        </notebook>
                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids"/>
                        <field name="activity_ids"/>
                        <field name="message_ids"/>
                    </div>
                </form>
            </field>
        </record>
        <!--Tree View-->
        <record id="view_tenancy_contract_tree" model="ir.ui.view">
            <field name="name">tenancy.contract.tree</field>
            <field name="model">tenancy.contract</field>
            <field name="arch" type="xml">
                <tree string="Tenancy Contract">
                    <field name="name" string="Code"/>
                    <field name="start_date" string="Start Date"/>
                    <field name="end_date" string="'Expiration Date"/>
                    <field name="state"/>
                </tree>
            </field>
        </record>

        <record model="ir.actions.act_window" id="action_tenancy_contract">
            <field name="name">Tenancy Contract</field>
            <field name="res_model">tenancy.contract</field>
            <field name="view_mode">tree,form,kanban</field>
            <field name="view_id" ref="view_tenancy_contract_tree"/>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                    No Record Found. Let's Create..........
                </p>
            </field>
        </record>

        <menuitem action="action_tenancy_contract" id="menu_tenancy_contract_root" name="Tenancy Contract"
                  parent="ol_property_custom.property_menu_act"
                  sequence="5"/>

        <!--   Cron job/ Schedule action which check the start date of Tenancy contract
        if start date is occure then the state will go to open/In Progress-->

        <record id="ir_cron_update_state" model="ir.cron">
            <field name="name">Update State Cron</field>
            <field name="model_id" ref="model_tenancy_contract"/>
            <field name="state">code</field>
            <field name="code">model._update_state_cron()</field>
            <field name="interval_number">1</field> <!-- Every day -->
            <field name="interval_type">days</field>
            <field name="numbercall">-1</field> <!-- Run indefinitely -->
            <field name="doall" eval="True"/>
            <field name="active" eval="True"/>
        </record>

        <record id="ir_cron_update_contract_state" model="ir.cron">
            <field name="name">Update Contract State Cron</field>
            <field name="model_id" ref="model_tenancy_contract"/>
            <field name="state">code</field>
            <field name="code">model._update_contract_state_cron()</field>
            <field name="interval_number">1</field> <!-- Every day -->
            <field name="interval_type">days</field>
            <field name="numbercall">-1</field> <!-- Run indefinitely -->
            <field name="doall" eval="True"/>
            <field name="active" eval="True"/>
        </record>

    </data>
</odoo>
